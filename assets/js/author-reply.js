var DOM=KISSY.DOM,Event=KISSY.Event;Detail.add("userEvent",function(a){Event.on("#detail","click",function(c){var b=c.target;if(DOM.hasClass(b,"J_authorReply")){authorReply(c)}else{if(DOM.attr(b,"id")=="replyFromreplyArea"){DOM.scrollIntoView("#publishreply")}else{if(DOM.hasClass(b,"J_replyUser")){userReply(c)}else{if(DOM.hasClass(b,"J_delAuReply")){submitData(c,"#authorReplyForm","\u4f60\u786e\u8ba4\u8981\u5220\u9664\u697c\u4e3b\u56de\u590d\uff1f\u5220\u9664\u4e4b\u540e\u4e0d\u80fd\u6062\u590d\u54e6\uff01")}else{if(DOM.hasClass(b,"J_delThread")){submitData(c,"#deleteThreadForm","\u4f60\u786e\u8ba4\u8981\u5220\u9664\u8be5\u5e16\u5b50\uff1f\u5220\u9664\u4e4b\u540e\u4e0d\u80fd\u6062\u590d\u54e6\uff01")}else{if(DOM.hasClass(b,"J_delReply")){submitData(c,"#replyForm","\u4f60\u786e\u8ba4\u8981\u5220\u9664\u8be5\u56de\u590d\uff1f\u5220\u9664\u4e4b\u540e\u4e0d\u80fd\u6062\u590d\u54e6\uff01")}else{if(DOM.hasClass(b,"J_floatThread")){submitData(c,"#floatThread")}else{if(DOM.hasClass(b,"J_sinkThread")){submitData(c,"#sinkThread")}}}}}}}}})});function authorReply(b){b.halt();var a=DOM.attr(b.target,"data-url");Detail.overlay.showDialog({src:a,width:345,headerContent:"\u697c\u4e3b\u56de\u590d"})}function userReply(a){a.halt();if(typeof(editor)!=undefined){data=DOM.attr(a.target,"data-url").split(",");userNick=data[0];floorId=data[1];str="[ANSWER]\u56de"+floorId+"\u697c\uff08"+userNick+"\uff09\u7684\u5e16\u5b50---[/ANSWER]<p></p>";window.location.href="#publishreply";editor.focus();editor.insertHtml(str)}else{window.location.href=DOM.attr(a.target,"href")+"#publishreply"}}function submitData(b,d,c){b.halt();var a=DOM.get(d);if(!a){return}if(a.replyId){a.replyId.value=DOM.attr(b.target,"data-url")}if(!c){a.submit()}else{if(window.confirm(c)){a.submit()}}}Detail.add("reply_success",function(a){function b(d){var e=DOM.get("#"+d.replyId+" .last-edit")||DOM.get("#"+d.replyId+" .article");var c=DOM.create('<div class="author-reply"></div>');c.innerHTML="<strong>\u697c\u4e3b\u56de\u590d\uff1a</strong><p>"+d.content+'</p><a href="javascript:void(0)" class="del J_delAuReply" data-url="'+d.replyId.substr(5)+'">\u5220\u9664</a>';DOM.insertAfter(c,e);a.overlay.hide()}return a.replySuccess=b});
