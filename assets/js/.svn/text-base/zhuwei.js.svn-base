(function(){TB.namespace("zhuweiDetail");var c=YAHOO.util.Dom,b=YAHOO.util.Event,a=YAHOO.util.Anim;TB.zhuweiDetail.zhuwei=function(d){var i=c.getElementsByClassName(d.floorClass);var g=this;var f=[];var e=i.length;var h=c.get("J_weiwang");var j=c.get("J_zhuweiIframe");j.hasSrc=false;this.init=function(){if(e<1){return}for(var k=0;k<e;k++){var l={};l._id=i[k].id;l._btn=c.getElementsByClassName(d.btnClass,"",l._id)[0];l._list=c.getElementsByClassName(d.listClass,"",l._id)[0];l._tableId=c.getElementsByClassName(d.tableClass,"",l._id)[0];f.push(l);(function(m){b.addListener(f[k]._btn,"click",function(){g.openZhuwei(f[m])})})(k);j.hasSrc=false}};this.createMask=function(){this.mask=c.get("mask");var k=this.mask;if(!k){k=document.createElement("div");k.className="mask";k.id="mask";document.body.appendChild(k)}c.setStyle(k,"opacity",0);c.setStyle(k,"width",c.getDocumentWidth()+"px");c.setStyle(k,"height",c.getDocumentHeight()+"px");b.addListener(window,"resize",function(){k.style.width=c.getDocumentWidth()+"px";k.style.height=c.getDocumentHeight()+"px"});this.mask=k};this.showMask=function(){this.createMask();var k=this.mask;c.setStyle(k,"display","block");c.setStyle(k,"opacity",0.5)};this.hiddenPopup=function(){j.hasSrc=false;c.setStyle(h,"display","none");c.setStyle(this.mask,"display","none");c.setStyle(this.mask,"opacity",0);c.setStyle(j,"display","none")};this.showPopup=function(){c.setStyle(h,"display","block");var k=c.get("J_close");if(!k){k=document.createElement("a");k.id="J_close";k.className="close act";h.appendChild(k)}b.addListener(k,"click",function(l){g.hiddenPopup();b.stopEvent(l)})};this.openZhuwei=function(n){var l=TB.bom.getCookie("cookie1")||TB.bom.getCookie("_l_g_");if(!l){var m=c.get("J_zhuweiIframe");var k=c.get("J_weiwang");k.className="pop-up";c.addClass(m,"pop-mask");m.style.height="200px";k.style.height="246px";m.style.width="368px";k.style.width="390px";k.style.marginLeft="-195px"}if(!j.hasSrc){j.src=n._btn.getAttribute(d.zhuweiUrl);j.hasSrc=true}setTimeout(function(){g.showMask();g.showPopup();c.setStyle(j,"display","block")},500)};this.success=function(q){var n=c.get(q.zhuweiId);var k=c.getElementsByClassName(d.listClass,"",n)[0];if(!k){return}var m=c.getElementsByClassName(d.tableClass,"",n)[0];if(!m){return}var o=c.getElementsByClassName(d.sumClass,"",n)[0];var p=m.getElementsByTagName("tr");if(c.getStyle(k,"display")=="none"){c.setStyle(k,"display","block")}if(p.length==0){var l=m.insertRow(0);l.insertCell(0).className="username";l.insertCell(1);l.insertCell(2).className="content"}else{var l=p[0].cloneNode(true);p[0].parentNode.insertBefore(l,p[0])}if(q.coin>0){l.cells[1].className="plus"}else{l.cells[1].className="neg"}l.cells[0].innerHTML="<a target='_blank' href='"+q.userCenterLink+"'>"+q.username+"</a>";l.cells[1].innerHTML="<s></s>"+q.coin;l.cells[2].innerHTML=q.content;o.innerHTML=o.innerHTML*1+q.coin*1;c.get("content").className="";g.hiddenPopup();window.location.replace(TB.common.parseUri(location.href)["prePath"]+TB.common.parseUri(location.href)["path"]+"?t="+Math.random()+"#"+q.zhuweiId)};this.failed=function(){g.hiddenPopup();c.get("content").className="";window.location.replace(location.href.replace(/#.*/,""))};this.init()}})();
