(function(c){var b=c.DOM,j=c.Event;var h=b.get("#J_FastReply"),g=b.get("textarea",h),i=b.get(".close",h),e=b.get("button",h),d=b.get("#checkCodeInput"),f="",a=function(){b.addClass(h,"hidden");b.removeClass(b.parent(h,".ft"),"autoheight")};j.on(i,"click",a);j.on(e,"click",function(){b.val("#msgpost",f+b.val(g));b.get("#addReplyForm").submit()});j.on(".replyArea","click",function(k){k.halt();if(!b.val("#J_EditorPlugins")){loginSuccess&&(loginSuccess.callback=function(){window.location.href=window.location.href.split("#")[0]});editor&&editor.fire("focus")}else{if(d){window.location.href="#publishreply"}else{var l=b.attr(this,"data-floor"),n=b.parent(this,".op"),m=b.parent(n,".ft");if(b.hasClass(m,"autoheight")){a()}else{a();if(l){l='<a href="'+window.location.href.split("#")[0]+"#"+b.attr(b.parent(this,".floor"),"id")+'">'+l+"</a>";b.insertBefore(h,n);b.addClass(m,"autoheight clearfix");b.removeClass(h,"hidden");g.innerHTML="";g.select();f=b.attr(g,"data-prefix").replace("{{floor}}",l)}else{window.location.href="#publishreply"}}}}})})(KISSY);