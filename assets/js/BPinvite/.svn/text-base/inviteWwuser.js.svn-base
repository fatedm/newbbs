(function(){var d=YAHOO,c=d.util.Dom,b=d.util.Event,a=document;TB.namespace("InviteLoadWw");TB.InviteLoadWw=function(){var k="J_INITWW",h="J_ZNUM",g="J_ANUM",f="J_InviteWw",j="J_InviteWwUl",i="J_InviteWwHTML";var l={tips:function(n){var m='<div class="msg"><p class="notice invite-error">'+n+"</p></div>";c.get(f).innerHTML=m},structureWW:function(n,q){var m=c.get(i).value;c.get(f).innerHTML=m;c.get(h).innerHTML=n.length;c.get(g).innerHTML=q;if(c.get(j)){var s=[];for(var o=0;o<n.length;o++){var t='<li><input type="checkbox" value="'+n[o]["ID"]+'" name="friendid" style="float:left;margin-top:3px;"><span class="J_WangWang" data-icon="small" data-nick="'+n[o]["nick"]+'" style="float:left;margin:-4px 5px 0px 5px;"></span><label style="line-height:17px;">'+n[o]["nick"]+"</label></li>";s.push(t)}var u=s.join("");c.get(j).innerHTML=u;var v=TB.MouseWheel({sBGElId:"slider-1",sHandleElId:"slider-thumb1",iDown:265,Maxheight:340,callback:function(w){if(w<340){c.getAncestorByTagName("slider-1","div").style.height=w+"px";c.getAncestorByTagName("slider-1","div").style.backgroundImage="none";c.get("slider-thumb1").parentNode.removeChild(c.get("slider-thumb1"))}}});var r=c.get("slider-1").getElementsByTagName("label"),p=c.get("slider-1").getElementsByTagName("input");TB.Customlabel(p,r);TB.InviteWw();TB.checknum(p,q);b.on(r,"click",function(){TB.checknum(p,q)});b.on(p,"click",function(){TB.checknum(p,q)});TB.ww.lightAll(c.get(j))}}};var e={success:function(p){var n=YAHOO.lang.JSON.parse(p.responseText);var m={success:function(){if(n.data.length==0){l.tips("您暂时没有旺旺好友，无法邀请好友加入帮派")}else{l.structureWW(n.data,n.allownum)}},error:function(){l.tips(n.msg)}};m[n.status]()},failure:function(){l.tips("很抱歉，目前暂时无法取得旺旺好友信息，请稍后再试!<a href='javascript:;' onclick='window.location.reload();'>重试</a>")},timeout:60000};if(c.get(k)&&c.get(i)){d.util.Connect.setForm(k);d.util.Connect.asyncRequest("POST","/json/getWangWangFriendsList.htm",e)}};TB.namespace("InviteWw");TB.InviteWw=function(){var i=c.get("J_InviteWwForm"),f="/json/inviteWangWangResult.htm",j=i.method,g=c.getElementsByClassName("J_Target","div","J_InviteWwWarp")[0],l="WWUSERVINET",k="J_InviteWwSub",e="WWPROGRESSBAR",m=true;var h={tips:function(o,q){var p=function(){var r=a.createElement("div");r.id=l;r.className="msg";r.innerHTML="<p class='"+o+"'>"+q+"</p>";c.get(g).appendChild(r)};if(c.get(l)){c.get(l).parentNode.removeChild(c.get(l));p()}else{p()}},createprogressbar:function(p){if(!c.get(e)){var o=a.createElement("div");o.id=e;o.innerHTML="<img src='http://img01.taobaocdn.com/tps/i1/T1G_BTXn4DXXXXXXXX-16-16.gif' /> "+p+"，请耐心等待...";c.insertAfter(o,k)}},clearprogressbar:function(){var o=c.get(e);if(o){o.parentNode.removeChild(o)}},revampallownum:function(p){var q=c.get("slider-1").getElementsByTagName("label"),o=c.get("slider-1").getElementsByTagName("input");c.get("J_ANUM").innerHTML=p;c.batch(o,function(r){r.checked="";r.disabled=""});b.removeListener(q);b.removeListener(o);TB.Customlabel(o,q);TB.checknum(o,p);b.on(q,"click",function(){TB.checknum(o,p)});b.on(o,"click",function(){TB.checknum(o,p)})}};var n={success:function(r){var q=YAHOO.lang.JSON.parse(r.responseText);h.clearprogressbar();var p={success:function(){h.tips("ok",q.msg);h.revampallownum(q.allownum)},error:function(){h.tips("error",q.msg);h.revampallownum(q.allownum)}};p[q.status]();m=true},failure:function(){h.tips("error","服务器请求相应超时！");m=true},timeout:60000};b.on(i,"submit",function(o){b.stopEvent(o);m=false;h.createprogressbar("正在邀请您的旺旺好友");c.get("allowNumber").value=c.get("J_ANUM").innerHTML;d.util.Connect.setForm(i);d.util.Connect.asyncRequest(j,f,n)})}})();