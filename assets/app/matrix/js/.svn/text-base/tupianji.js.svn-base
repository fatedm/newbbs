KISSY.ready(function(b){var d=b.DOM,c=b.Event,a=b.query(".J-photoWrapper");b.each(a,function(i){var q=b.query("li",i),o=b.get("img",i),j=b.get(".pw-des"),g=b.get(".des-info",i),k=b.get(".prev",i),h=b.get(".next",i),f=b.get("ul",i),m=d.query("li",f),l=b.get(".pw-content",i);d.css(j,"height",g.offsetHeight);q.each(function(s,r){if(d.hasClass(s,"current")){i.currentIndex=r;e(s)}p();c.on(s,"click",function(){e(s)});var t=b.get("a",s);c.on(t,"click",function(u){u.preventDefault();return false});c.on(t,"focus",function(){this.blur()})});if(!i.currentIndex){e(q[0])}function e(t){var s=b.get("img",b.get("a",t)),r=b.get("blockquote",t);d.attr(o,"src",d.attr(s,"lazyload"));g.innerHTML=r.innerHTML;q.each(function(u){if(t!==u){d.removeClass(u,"current")}});d.addClass(t,"current");i.currentIndex=b.indexOf(t,q);p();if(b.indexOf(t,q)<=6){k.className="disabled-prev"}else{k.className="prev"}if(Math.ceil((i.currentIndex+1)/7)===Math.ceil(d.query("li",f).length/7)){h.className="disabled-next"}else{h.className="next"}b.Anim(d.parent(g),"height: "+g.offsetHeight+"px",0.2,"easeOut").run()}function p(){if(isNaN(i.currentIndex)){i.currentIndex=0}else{i.currentPage=parseInt(i.currentIndex/7,10)}}function n(y){p();var u=i.currentPage,s,x,r=b.get(".pw-content",i).offsetWidth,v=(q.length%7),w=u*7;if(y=="next"){var t=Math.ceil((q[0].offsetWidth*q.length)/r);if(u<t-1){u++}if(u==1){s=-r}else{s=-(u*r)}}if(y=="prev"){if(u<=1){s=0}else{s=-((u-1)*r)}}b.Anim(f,"left: "+s+"px",0.1,"easeOut",function(){var z=(-s)/r;if(z==0){if(y=="next"){e(q[0])}else{e(q[6])}}else{if(y=="next"){e(q[(z*7)])}else{e(q[(z*7)+6])}}}).run()}c.on(o,"mouseup",function(z){var u=i.currentIndex,s=u+1,y=u-1,r;if(s>=q.length){s=q.length-1}if(y<0){y=0}r=z.layerX;if(!r){r=z.offsetX}var w=parseInt((i.currentIndex+1)/7,10),v=parseInt((i.currentIndex)/7,10),t=parseInt((i.currentIndex-1)/7,10);if(r<z.currentTarget.offsetWidth/2){if(t<v){n("prev")}else{e(q[y])}e(q[y])}else{if(!d.hasClass(m[s],"current")){if(w>v){n("next")}else{e(q[s])}}}});c.on(o,"mousemove click",function(s){var r=s.layerX;if(!r){r=s.offsetX}if(r&&r>=0){if(r<s.currentTarget.offsetWidth/2&&i.currentIndex!==0){this.className="prev"}if(i.currentIndex===0&&r<s.currentTarget.offsetWidth/2||m.leng<=7){this.className=""}if(r>s.currentTarget.offsetWidth/2&&i.currentIndex!==m.length-1){this.className="next"}if(r>s.currentTarget.offsetWidth/2&&i.currentIndex===m.length-1||m.leng<=7){this.className=""}}});c.on(k,"click",function(r){if(!d.hasClass(this,"disabled-prev")){n("prev")}r.halt()});c.on(h,"click",function(r){if(!d.hasClass(this,"disabled-next")){n("next")}r.halt()});c.on([k,h],"focus",function(){this.blur()})})});
